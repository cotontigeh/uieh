---
import { Nav as NavUIEH, NavContainer, NavLink, Button } from "uieh";
import { routes } from "../../config/routes";
import { Theme } from "../React/Theme/Theme";
---

<NavUIEH color="base">
  <NavContainer>
    <!-- Logo -->
    <NavLink
      className="text-xl font-bold mr-2 border-1 border-base-300 dark:border-base-300-dark"
      href={routes.home.to}
    >
      UIEH
    </NavLink>

    <!-- Links -->
    <NavLink
      color="base"
      active={Astro.url.pathname === routes.home.to}
      href={routes.home.to}
    >
      {routes.home.name}
    </NavLink>
    <NavLink
      color="base"
      active={Astro.url.pathname.includes(routes.docs.to)}
      href={routes.docs.to}
    >
      {routes.docs.name}
    </NavLink>

    <!-- Socials buttons -->
    <Button className="ml-auto">
      <a href="https://github.com/cotontigeh/uieh" target="_blank"> Github </a>
    </Button>
    <Button color="secondary" disabled> Discord </Button>

    <!-- Theme toggle -->
    <div id="themeToggle" class="cursor-pointer select-none">
      <span class="dark:font-bold">Dark</span>/
      <span class="font-bold dark:font-normal">Light</span>
    </div>
  </NavContainer>
</NavUIEH>

<script is:inline>
  const theme = (() => {
    // Initialize from localStorage or system preference
    const localStorageTheme = localStorage.getItem('theme')

    if (['dark', 'light'].includes(localStorageTheme)) {
      return localStorageTheme;
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
      return 'light';
  })();

  if (theme === 'light') {
    document.documentElement.classList.remove('dark');
  } else {
    document.documentElement.classList.add('dark');
  }

  window.localStorage.setItem('theme', theme);

  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");

    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  }

  document.getElementById("themeToggle")?.addEventListener("click", handleToggleClick);
</script>